ğŸ“˜ Tutorial: Como funciona o cÃ³digo da Lixeira Inteligente com Sensor UltrassÃ´nico

Este cÃ³digo transforma uma lixeira comum em uma lixeira inteligente, capaz de:

Medir constantemente a distÃ¢ncia entre o sensor e o lixo.

Informar via Serial se a lixeira estÃ¡ cheia ou ok.

Fazer o LED piscar quando estiver cheia.

Enviar leituras suavizadas para evitar mediÃ§Ãµes malucas.

Manter estabilidade mesmo com leituras erradas ou instÃ¡veis.

Vamos por partes! ğŸ‘‡





1ï¸âƒ£ Componentes usados

O cÃ³digo utiliza:

Sensor UltrassÃ´nico HC-SR04

TRIG â†’ envia o pulso

ECHO â†’ recebe o pulso (eco)

LED â†’ Pisca quando a lixeira estÃ¡ cheia

Arduino (uno, nano etc.)

Pinos utilizados:

Componente	Pino Arduino
TRIG	10
ECHO	9
LED	12




2ï¸âƒ£ O que Ã© considerado â€œlixeira cheiaâ€?
const float DISTANCIA_CHEIA = 10.0; // cm
Se o lixo chega a 10cm ou menos do sensor, a lixeira Ã© considerada cheia.




3ï¸âƒ£ Como a leitura da distÃ¢ncia funciona

O ultrassÃ´nico funciona assim:

O Arduino envia um pulso pelo pino TRIG.

O pulso bate no lixo e volta como eco.

O pino ECHO recebe o tempo desse retorno.

O cÃ³digo converte esse tempo em centÃ­metros:

return duracao / 58.2;


Isso Ã© padrÃ£o do HC-SR04.




4ï¸âƒ£ Leitura mais estÃ¡vel: mÃ©dia + suavizaÃ§Ã£o

Para evitar leituras malucas como â€œ3 cmâ€, â€œ97 cmâ€, â€œ0 cmâ€, o cÃ³digo:

âœ” Faz 10 leituras rÃ¡pidas
âœ” Ignora leituras zeradas
âœ” Calcula a mÃ©dia
âœ” Aplica suavizaÃ§Ã£o exponencial (EMA)

Trecho:

distanciaFiltrada = (alpha * media) + ((1 - alpha) * distanciaFiltrada);


Isso mantÃ©m o valor estÃ¡vel, ideal para monitoramento real.





5ï¸âƒ£ Envio contÃ­nuo para o Python

O cÃ³digo manda sempre a distÃ¢ncia filtrada:

Serial.print("DISTANCIA:");
Serial.print(distanciaFiltrada, 2);
Serial.println(" cm");
O Python pode ler essas mensagens continuamente.





6ï¸âƒ£ DetecÃ§Ã£o de lixeira cheia
bool cheiaAgora = distanciaFiltrada <= DISTANCIA_CHEIA;


Se ficar cheia, o Arduino envia:

LIXEIRA_CHEIA


Quando volta ao normal:

LIXEIRA_OK





7ï¸âƒ£ LED piscando quando cheia

Quando cheia, o LED:

Acende

Apaga

A cada 500 ms

Isso cria um alerta visual:

estadoLed = !estadoLed;
digitalWrite(LED, estadoLed);






8ï¸âƒ£ ProteÃ§Ã£o contra â€œdriftâ€

A cada 1 minuto, o Arduino reduz gradualmente o valor filtrado:

distanciaFiltrada *= 0.5;
Isso impede que erros acumulados deixem o sistema doido com o tempo.





9ï¸âƒ£ FunÃ§Ã£o medirDistancia()

Essa funÃ§Ã£o Ã© o "coraÃ§Ã£o" do sensor:

pulseIn(ECHO, HIGH, TIMEOUT);

Se passar do timeout de 30 ms â†’ retorna zero.

Isso evita travamentos caso nÃ£o haja eco.






ğŸ”Ÿ Resumo do fluxo do sistema (simples)

Mede a distÃ¢ncia 10 vezes

Faz mÃ©dia e suavizaÃ§Ã£o

Envia leitura para o Python

Se distÃ¢ncia â‰¤ 10cm â†’ lixeira cheia

LED comeÃ§a a piscar

Se voltar a ficar longe â†’ normaliza

Reinicia suavizaÃ§Ã£o a cada 1 min






ğŸŸ¢ Em outras palavras...

Esse cÃ³digo garante que:

As leituras nÃ£o variem bruscamente.

O Python saiba exatamente quando a lixeira estÃ¡ cheia.

O LED avise localmente.

O sistema nunca trave mesmo se o sensor errar.

Ã‰ um sistema confiÃ¡vel, estÃ¡vel e inteligente para monitorar lixeiras.